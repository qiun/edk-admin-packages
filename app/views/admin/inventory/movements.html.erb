<% content_for :page_title, "Historia ruchów magazynowych" %>

<div class="space-y-6">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <div class="flex items-center gap-2">
        <%= link_to admin_inventory_path, class: "text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300" do %>
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        <% end %>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Historia ruchów magazynowych</h1>
      </div>
      <p class="text-gray-600 dark:text-gray-400 mt-1">Wszystkie ruchy dla edycji <%= @edition.name %></p>
    </div>
  </div>

  <!-- Movements Table -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">#</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Data</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Typ</th>
            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Ilość</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Notatka</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Dodane przez</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase">Referencja</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
          <% @moves.each do |move| %>
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50">
              <td class="px-6 py-4 text-sm font-medium text-gray-900 dark:text-white">#<%= move.id %></td>
              <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">
                <%= move.created_at.strftime("%d.%m.%Y %H:%M") %>
              </td>
              <td class="px-6 py-4">
                <% move_type_labels = {
                  'stock_in' => 'Dostawa',
                  'reserve' => 'Rezerwacja',
                  'release' => 'Zwolnienie',
                  'ship' => 'Wysyłka',
                  'return_received' => 'Zwrot'
                } %>
                <% move_type_colors = {
                  'stock_in' => 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400',
                  'reserve' => 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400',
                  'release' => 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400',
                  'ship' => 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400',
                  'return_received' => 'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400'
                } %>
                <span class="inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium <%= move_type_colors[move.move_type] || 'bg-gray-100 text-gray-800' %>">
                  <%= move_type_labels[move.move_type] || move.move_type&.humanize %>
                </span>
              </td>
              <td class="px-6 py-4 text-center text-sm font-medium text-gray-900 dark:text-white">
                <%= move.quantity %>
              </td>
              <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">
                <%= move.notes || '-' %>
              </td>
              <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">
                <%= move.created_by&.full_name || '-' %>
              </td>
              <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">
                <% if move.reference_type.present? && move.reference_id.present? %>
                  <%= move.reference_type %> #<%= move.reference_id %>
                <% else %>
                  -
                <% end %>
              </td>
            </tr>
          <% end %>
          <% if @moves.empty? %>
            <tr>
              <td colspan="7" class="px-6 py-12 text-center text-gray-500 dark:text-gray-400">
                Brak ruchów magazynowych
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
